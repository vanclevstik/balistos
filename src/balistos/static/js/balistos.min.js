(function($){"use strict";
 $("#hide-player").click(function(){$(this).hide();$(".player").hide();player.destroy();player=null;$("#show-player").fadeIn();});$("#show-player").click(function(){$(this).hide();initPlayer();$(".player").fadeIn();$("#hide-player").fadeIn();});$(document).click(function(){$('#response-playlist').hide();});$(document).on("click","#response-playlist",function(event){event.stopPropagation();});$(document).on("click",".protected_playlist",function(event){event.preventDefault();$(this).parents("li").find("form").fadeToggle();});$(document).on("submit",".protected_playlist_form",function(event){var uri=$(this).find("input").attr("data-uri");var item=$(this).parents("li");event.preventDefault();$.ajax({type:"GET",url:"/authenticate_playlist",dataType:"json",data:{"password":$(this).find("input").val(),"uri":uri}}).done(function(data){if(data.success){window.location.href="/playlist/"+uri;}
else if(error){item.find(".playlist_password_error").text(data.error);}});});$("#search-playlist").keyup(function(){$.ajax({type:"GET",url:"/search_playlists",dataType:"json",data:{"query":$(this).val()}}).done(function(data){if(data.length<1){$("#response-playlist").html('No results for this query...');$("#response-playlist").show();}
else{$("#response-playlist").html("");$.each(data,function(index,value){$("#response-playlist").append('<a href="'+'/playlist/'+value.uri+'"><div class="title">'
+value.title+'</div><div class="'+'description">'+value.description+'</div></a>');});$("#response-playlist").show();}});});$("#login-form").on("submit",function(event){$("#login-form input").removeClass("red");$("#login-form .error").text("");event.preventDefault();$.ajax({type:"POST",url:"/login",dataType:"json",data:{"login-username":$(this).find("#login-username").val(),"login-password":hex_sha256($(this).find("#login-password").val())},}).done(function(response){if(response.error){$("#login-username-error").text(response.error).show();$("#login-form input").addClass("red");$("#login-password").val("");}
else{window.location.reload();}});});$("#register-form").on("submit",function(event){event.preventDefault();$("#register-form input").removeClass("red");$("#register-form .error").text("");if($(this).find("input[name='register-password']").val().length<5){$("#registration-password-error").text("Your password is too short.");$("#register-password").addClass("red");$("#register-form").find("input[type='password']").val("");}
else if($(this).find("input[name='register-username']").val().length<5){$("#registration-username-error").text("Your username is too short.");$("#register-username").addClass("red");}
else if(!validateEmail($(this).find("input[name='register-email']").val())){$("#registration-email-error").text("Your email is not valid.");$("#register-email").addClass("red");}
else{if($(this).find("#register-password").val()==$(this).find("#register-repeat").val()){$.ajax({type:"POST",url:"/register",dataType:"json",data:{"register-username":$(this).find("#register-username").val(),"register-password":hex_sha256($(this).find("#register-password").val()),"register-email":$(this).find("#register-email").val(),},}).done(function(response){if(response.error){$("#registration-email-error").text(response.error);$("#register-email").addClass("red");}
else{window.location.reload();}});}
else{$("#registration-repeat-error").text("Passwords don't match.");$("#register-repeat").addClass("red");$("#register-form").find("input[type='password']").val("");}}});$("#chat-form").submit(function(){$.ajax({type:"POST",url:"/chat_message",dataType:"json",data:$(this).serialize(),}).done(function(data){playlist.sync();});$(this).find("textarea").val("");return false;});$("#volume-slider").simpleSlider();$("#volume-slider").bind("slider:changed",function(event,data){if(player){player.setVolume(parseInt(data.value*100));}});$(".speaker").click(function(){$("#volume-slider").simpleSlider("setValue",0);if(player){player.setVolume(0);}});function validateEmail(email){return/^.+@.+\..+$/.test(email);}
$(".user").click(function(e){e.stopPropagation();$("#logout").slideDown();});$(".open-login").click(function(e){e.stopPropagation();$(".menu-button").removeClass("active");$(".open-login").addClass("active");$(".dropdown").hide();$("#login").slideDown();});$(".open-register").click(function(e){e.stopPropagation();$(".menu-button").removeClass("active");$(".open-register").addClass("active");$(".dropdown").hide();$("#register").slideDown();});$(".dropdown").click(function(e){e.stopPropagation();});$(document).click(function(){$(".menu-button").removeClass("active");$(".dropdown").hide();});}(jQuery));